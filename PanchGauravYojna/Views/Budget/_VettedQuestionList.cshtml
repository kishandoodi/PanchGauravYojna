@model MO.BudgetMaster.VettedQuestions
@{
   
    var nonce = Context.Items["CSPNonce"]?.ToString();
}
<div class="modal fade" id="vettedModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Vetted Entries</h5>
                <button type="button" class="btn-close"
                        data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <!-- Dynamic Form -->
                <div id="dynamicFormContainervetted" class="p-4 bg-light border-start border-3 border-primary rounded shadow-sm mb-4">
                    @* JS will generate full form *@
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary"
                        data-bs-dismiss="modal">
                    Close
                </button>
            </div>

        </div>
    </div>
</div>
@section Scripts {
    <script nonce="@nonce"
            src="~/custom/budgetmaster.js" asp-append-version="true"></script>
}
<script nonce="@nonce">
    const questions = @Html.Raw(Json.Serialize(Model.mainquestion))
    const activityList = @Html.Raw(Json.Serialize(ViewBag.ActivityTypes))  // FIXED
    const savedRows = @Html.Raw(Json.Serialize(ViewBag.List))
    const gauravGuid = '@Model.GauravGuid';
</script>

<script nonce="@nonce">
        $(document).on('focus', '.datepicker', function () {
        $(this).datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            todayHighlight: true
        });
    });

        function getVal(id) {
            var el = document.getElementById(id);
            return el && el.value ? parseFloat(el.value) : 0;
        }

        function calculatePanchGaurav() {

            var totalProposed = getVal('TotalProposed');
            var nodal = getVal('NodalAmount');
            var mplad = getVal('MPLADAmount');
            var csr = getVal('CSRAmount');
            var other = getVal('OtherAmount');

            var totalExpense = nodal + mplad + csr + other;
            var panchGaurav = totalProposed - totalExpense;

            // if (panchGaurav < 0) {
            //     panchGaurav = 0;
            // }

            var pg = document.getElementById('PanchGauravAmount');
            if (pg) {
                pg.value = panchGaurav;
            }
        }


      $(document).on(
        "input change",
        "#TotalProposed,#NodalAmount,#MPLADAmount,#CSRAmount,#OtherAmount",
        calculatePanchGaurav
    );


</script>