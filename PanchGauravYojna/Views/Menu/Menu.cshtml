@using MO.Common
@using MO.MenuMaster;
@using Newtonsoft.Json;
@using Newtonsoft.Json.Linq;
@model MO.MenuMaster.MenuMO
@{
    ViewData["Title"] = "Menu";
    Layout = "~/Views/Shared/_LayoutIn.cshtml";
}
@{
    JObject obj = JObject.Parse(JsonConvert.SerializeObject(new MenuList(), Formatting.Indented, new JsonSerializerSettings
    { PreserveReferencesHandling = PreserveReferencesHandling.Objects }));
    obj.Remove("$id");
    obj.Remove("MenuId");
    obj.Remove("HeaderMenu");
    List<string>
    termsList = new List<string>();
    foreach (var columnName in obj)
    {
        termsList.Add(columnName.Key.Trim());
    }
    string[] columnArray = termsList.ToArray();
}
@{
    var nonce = Context.Items["CSPNonce"]?.ToString();
    MenuPermissionMO p = ViewBag.Permission as MenuPermissionMO ?? new MenuPermissionMO();
}
<div class=""> 
    <div class="row">
        <div class="col-12 col-lg-12">
            <div class="card radius-10">
            @if (p?.CanAdd == true || p?.CanEdit == true){
                <div class="card-header color-header headercolor7">
                    <div class="d-flex align-items-center">
                        <div>
                            <h6 class="mb-0 ">Menu</h6>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div>
                        <input type="hidden" asp-for="Guid" id="Guid" name="Guid" />
                        <input type="hidden" asp-for="HeaderMenu" id="hiddenHeaderMenu" />
                        <div class="form-group row">
                            <div class="col-lg-3">
                                <label>Name<span class="text-danger">*</span></label>
                                <input type="text" class="form-control form-control-sm alphaspace" id="Name" placeholder="Enter Name" maxlength="200" asp-for="Name">
                                <div>
                                    <label for="error" class="mt-0 text-danger" id="errorName" style="color:red; font-size:13px;"></label>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <label for="exampleInputPassword1">MangalName<span class="text-danger">*</span></label>
                                <input type="text" class="form-control form-control-sm alphaspace" id="MangalName" placeholder="Enter MangalName" asp-for="MangalName" maxlength="200">
                                <div><label for="error" class="mt-0 text-danger" id="errorMangalName" style="color:red; font-size:13px;"></label></div>
                            </div>
                            <div class="col-lg-3">
                                <label for="exampleInputPassword1">Controller<span class="text-danger">*</span></label>
                                <input type="text" class="form-control form-control-sm" id="Controller" placeholder="Enter Controller" asp-for="Controller" maxlength="200">
                                <div><label for="error" class="mt-0 text-danger" id="errorController" style="color:red; font-size:13px;"></label></div>
                            </div>
                            <div class="col-lg-3">
                                <label for="exampleInputPassword1">ActionName<span class="text-danger">*</span></label>
                                <input type="text" class="form-control form-control-sm" id="ActionName" placeholder="Enter ActionName" asp-for="ActionName" maxlength="200">
                                <div><label for="error" class="mt-0 text-danger" id="errorActionName" style="color:red; font-size:13px;"></label></div>
                            </div>
                            <div class="col-lg-3">
                                <label for="exampleInputPassword1">OrderNumber<span class="text-danger">*</span></label>
                                <input type="number" class="form-control form-control-sm numberonly" id="OrderNumber" placeholder="Enter OrderNumber" asp-for="OrderNumber" maxlength="3">
                                <div><label for="error" class="mt-0 text-danger" id="errorOrderNumber" style="color:red; font-size:13px;"></label></div>
                            </div>
                            <div class="col-lg-3">
                                <label for="exampleInputPassword1">Icon<span class="text-danger">*</span></label>
                                <input type="text" class="form-control form-control-sm" id="Icon" placeholder="Enter Icon" asp-for="Icon" maxlength="50">
                                <div><label for="error" class="mt-0 text-danger" id="errorIcon" style="color:red; font-size:13px;"></label></div>
                            </div>
                            <div class="col-lg-3 d-flex flex-column justify-content-center mt-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="IsActive" asp-for="IsActive">
                                    <label class="form-check-label" for="IsActive">IsActive</label>
                                    <div>
                                        <label for="error" class="mt-1 text-danger" id="errorIsactive" style="display:none;color:red;"></label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="form-group" style="margin-top:10px">
                                    <button type="submit" class="btn btn-primary me-2 save-menu">@Model.BtnSave</button>
                                    <a asp-action="Menu" asp-asp-controller="Menu" class="btn btn-danger">Cancel</a>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                }
                
            @if (p?.CanList == true)
{
                <div class="card-header color-header headercolor7">
                    <div class="d-flex align-items-center">
                        <div>
                            <h6 class="mb-0 ">Menu List</h6>
                        </div>
                    </div>
                </div>

                <div class="card-body">
                    <div class="row">
                        <div class="col-12">
                            <div class="">
                                <table id="data_list" class="table table-striped table-bordered dataTable no-footer">
                                    <thead>
                                        <tr>
                                            @foreach (var item in columnArray)
                                            {
                                                <th>@item</th>

                                            }
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                }
            </div>
        </div>
    </div>
</div>
<script nonce="@nonce" src="~/custom/Common.js" asp-append-version="true"></script>
<script nonce="@nonce" src="~/custom/table.js"></script>
<script nonce="@nonce" src="~/custom/manageMaster/MMenu.js" asp-append-version="true"></script>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script nonce="@nonce">
        document.addEventListener("DOMContentLoaded", function () {
            var data = {};
                    table.BindPostTable("/Menu/MenudataList", 'data_list', data);
        });
    </script>
}
