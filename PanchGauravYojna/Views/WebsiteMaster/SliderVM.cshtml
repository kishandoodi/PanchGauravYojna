@using MO.Common
@model MO.WebsiteMaster.SliderCreateVM
@{
    ViewData["Title"] = "Add Slider";
    Layout = "~/Views/Shared/_LayoutIn.cshtml";
    var nonce = Context.Items["CSPNonce"]?.ToString();
    MenuPermissionMO p = ViewBag.Permission as MenuPermissionMO ?? new MenuPermissionMO();
}
<style nonce="@nonce">
    /* Overlay */
    .manual-modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
        justify-content: center;
        align-items: center;
    }

    /* Modal box */
    .manual-modal-content {
        position: relative;
        background: #fff;
        padding: 10px;
        border-radius: 6px;
        max-width: 90%;
        max-height: 90%;
        box-shadow: 0 5px 20px rgba(0,0,0,0.4);
    }

    /* Image */
    .manual-modal-image {
        max-width: 100%;
        max-height: 80vh;
        object-fit: contain;
        display: block;
    }

    /* Close button */
    .manual-close {
        position: absolute;
        top: 5px;
        right: 10px;
        font-size: 28px;
        font-weight: bold;
        color: #000;
        cursor: pointer;
    }

        .manual-close:hover {
            color: red;
        }

    .action-btn {
        min-width: 90px;
        text-align: center;
    }
</style>
<div class="card radius-10">
    <div class="card-header color-header headercolor1">
        <div class="d-flex align-items-center justify-content-between w-100">
            <!-- Title -->
            <h6 class="mb-0">Add Silder Image</h6>
        </div>
    </div>
    <div class="card-body">
        <!-- ===================== FORM SECTION ===================== -->
        @if (p?.CanAdd == true || p?.CanEdit == true)
        {
            <form asp-action="SliderVM" asp-controller="WebsiteMaster"
                  method="post" enctype="multipart/form-data">

                <input type="hidden" asp-for="Id" />
                <input type="hidden" asp-for="ExistingImage" />

                <div class="form-group">
                    <label>Slider Image</label>
                    <input type="file" asp-for="ImageFile" class="form-control" accept="image/*" data-val="false" />
                    <small class="text-muted">On updation Leave empty to keep old file(only image)</small>
                </div>

                <div class="form-group">
                    <label>Title</label>
                    <input type="text" asp-for="Title" class="form-control" />
                </div>

                <div class="form-group">
                    <label>Display Order</label>
                    <input type="number" asp-for="DisplayOrder" class="form-control" min="1" />
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" asp-for="IsActive" />
                        Is Active
                    </label>
                </div>

                <button type="submit" class="btn btn-primary" id="btnSave">
                    Save
                </button>
                <button type="button"
                        class="btn btn-secondary d-none"
                        id="btnCancel">
                    Cancel
                </button>
            </form>
        }
        <hr />

        <div class="table-responsive shadow-sm">
            @if (p?.CanList == true)
            {
                <table class="table table-bordered table-hover align-middle" id="slider_Table">
                    <thead class="table-success text-center">
                        <tr>
                            <th>#</th>
                            <th>Image</th>
                            <th>Title</th>
                            <th>Display Order</th>
                            <th>Is Active</th>
                            <th>Change Status</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.SliderList != null && Model.SliderList.Any())
                        {
                            int i = 1;
                            foreach (var item in Model.SliderList)
                            {
                                <tr>
                                    <td class="text-center">@i</td>
                                    <td class="text-center">
                                        @* <img src="@item.ImageBase64"
                                 style="height:60px;" /> *@
                                        <button type="button"
                                                class="btn btn-sm btn-info view-image-btn"
                                                data-image="@item.ImageBase64">
                                            View
                                        </button>
                                    </td>
                                    <td>@item.Title</td>
                                    <td class="text-center">@item.DisplayOrder</td>
                                    <td class="text-center">
                                        @(item.IsActive ? "Active" : "Inactive")
                                    </td>
                                    <td class="text-center">
                                        @if (p?.CanActiveDeactive == true)
                                        {
                                            <button type="button"
                                                    class="btn btn-sm action-btn toggle-status-btn @(item.IsActive ? "btn-secondary" : "btn-success")"
                                                    data-id="@item.Id"
                                                    data-status="@item.IsActive">
                                                @(item.IsActive ? "Deactivate" : "Activate")
                                            </button>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning">No Access</span>
                                        }
                                    </td>
                                    <td class="text-center">
                                        @if (p?.CanEdit == true)
                                        {
                                            <button type="button"
                                                    class="btn btn-sm action-btn btn-warning edit-btn"
                                                    data-id="@item.Id"
                                                    data-title="@item.Title"
                                                    data-order="@item.DisplayOrder"
                                                    data-active="@item.IsActive"
                                                    data-image="@item.ImageBase64">
                                                Edit
                                            </button>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning">No Access</span>
                                        }
                                    </td>
                                    <td class="text-center">
                                        @if (p?.CanDelete == true)
                                        {
                                            <button class="btn btn-sm action-btn btn-danger del-btn" data-sliderid="@item.Id">Delete</button>
                                        }
                                        else
                                        {
                                            <span class="badge bg-warning">No Access</span>
                                        }
                                    </td>
                                </tr>
                                i++;
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="8" class="text-center text-danger">
                                    No record found
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>
</div>
@* <div class="modal fade" id="imageModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Slider Image</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-center">
                <img id="modalImage"
                     class="img-fluid modal-image" />
            </div>
        </div>
    </div>
</div> *@
<!-- Manual Modal -->
<div id="imageModalManual" class="manual-modal">
    <div class="manual-modal-content">
        <span class="manual-close">&times;</span>
        <img id="modalImage" class="manual-modal-image" />
    </div>
</div>

<script nonce="@nonce"
        src="~/custom/websitemaster.js"
        asp-append-version="true"></script>

